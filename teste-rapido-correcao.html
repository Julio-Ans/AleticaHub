<!DOCTYPE html>
<html>
<head>
    <title>Teste Rápido - Status da Correção</title>
    <style>
        body { font-family: Arial, sans-serif; background: #1a1a1a; color: white; padding: 20px; }
        .test-result { background: #2a2a2a; border: 2px solid; padding: 15px; margin: 10px 0; border-radius: 8px; }
        .success { border-color: #10b981; }
        .error { border-color: #ef4444; }
        .loading { border-color: #f59e0b; }
    </style>
</head>
<body>
    <h1>🔍 Teste Rápido - Status da Página de Esportes</h1>
    
    <div id="test-auth" class="test-result loading">
        <h3>📱 Teste 1: Verificação de Autenticação</h3>
        <p id="auth-status">Verificando...</p>
    </div>
    
    <div id="test-api" class="test-result loading">
        <h3>🌐 Teste 2: API de Esportes</h3>
        <p id="api-status">Verificando...</p>
    </div>
    
    <div id="test-page" class="test-result loading">
        <h3>📄 Teste 3: Página de Esportes</h3>
        <p id="page-status">Verificando...</p>
    </div>

    <script>
        const API_BASE = 'https://atleticahubapi.onrender.com';
        
        // Teste 1: Verificar se há token
        function testeAuth() {
            const authDiv = document.getElementById('test-auth');
            const authStatus = document.getElementById('auth-status');
            
            const token = localStorage.getItem('authToken') || localStorage.getItem('athletica_token');
            
            if (token) {
                authDiv.className = 'test-result success';
                authStatus.innerHTML = `✅ Token encontrado: ${token.substring(0, 20)}...`;
            } else {
                authDiv.className = 'test-result error';
                authStatus.innerHTML = '❌ Nenhum token encontrado (modo visitante)';
            }
        }
        
        // Teste 2: Testar API diretamente
        async function testeAPI() {
            const apiDiv = document.getElementById('test-api');
            const apiStatus = document.getElementById('api-status');
            
            try {
                const response = await fetch(`${API_BASE}/api/esportes`, {
                    method: 'GET',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    apiDiv.className = 'test-result success';
                    apiStatus.innerHTML = `✅ API funcionando! Encontrados ${Array.isArray(data) ? data.length : 'N/A'} esportes`;
                } else {
                    apiDiv.className = 'test-result error';
                    apiStatus.innerHTML = `❌ API falhou: ${response.status} ${response.statusText}`;
                }
            } catch (error) {
                apiDiv.className = 'test-result error';
                apiStatus.innerHTML = `🚨 Erro na API: ${error.message}`;
            }
        }
        
        // Teste 3: Verificar se a página carrega
        function testePagina() {
            const pageDiv = document.getElementById('test-page');
            const pageStatus = document.getElementById('page-status');
            
            // Simular teste de carregamento da página
            const iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            iframe.src = 'http://localhost:3001/sports';
            
            iframe.onload = function() {
                pageDiv.className = 'test-result success';
                pageStatus.innerHTML = '✅ Página de esportes carregou com sucesso!';
                document.body.removeChild(iframe);
            };
            
            iframe.onerror = function() {
                pageDiv.className = 'test-result error';
                pageStatus.innerHTML = '❌ Erro ao carregar a página de esportes';
                document.body.removeChild(iframe);
            };
            
            document.body.appendChild(iframe);
            
            // Timeout de segurança
            setTimeout(() => {
                if (iframe.parentNode) {
                    pageDiv.className = 'test-result error';
                    pageStatus.innerHTML = '⏱️ Timeout - página demorou muito para carregar';
                    document.body.removeChild(iframe);
                }
            }, 10000);
        }
        
        // Executar todos os testes
        testeAuth();
        testeAPI();
        testePagina();
    </script>
</body>
</html>
