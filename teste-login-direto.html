<!DOCTYPE html>
<html>
<head>
    <title>Teste Login Simples</title>
</head>
<body>
    <h1>Teste Login Direto</h1>
    
    <form onsubmit="testarLogin(event)">
        <div>
            <label>Email:</label>
            <input type="email" id="email" value="admin@test.com" required>
        </div>
        <div>
            <label>Senha:</label>
            <input type="password" id="password" value="123456" required>
        </div>
        <button type="submit">Fazer Login</button>
    </form>
    
    <div id="resultado"></div>
    
    <div>
        <button onclick="verificarToken()">Verificar Token Ap√≥s Login</button>
        <div id="token-status"></div>
    </div>

    <script>
        function verificarToken() {
            const token1 = localStorage.getItem('authToken');
            const token2 = localStorage.getItem('athletica_token');
            
            document.getElementById('token-status').innerHTML = `
                <p><strong>authToken:</strong> ${token1 ? 'Presente (' + token1.length + ' chars)' : 'Ausente'}</p>
                <p><strong>athletica_token:</strong> ${token2 ? 'Presente (' + token2.length + ' chars)' : 'Ausente'}</p>
                ${token1 ? '<details><summary>Ver Token</summary><pre>' + token1 + '</pre></details>' : ''}
            `;
        }
        
        async function testarLogin(event) {
            event.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const resultDiv = document.getElementById('resultado');
            
            try {
                resultDiv.innerHTML = '<p>üîÑ Fazendo login...</p>';
                
                // Primeiro, obter configura√ß√£o do Firebase
                const configResponse = await fetch('https://atleticahubapi.onrender.com/config/firebase');
                if (!configResponse.ok) {
                    throw new Error('Erro ao obter configura√ß√£o do Firebase');
                }
                const firebaseConfig = await configResponse.json();
                resultDiv.innerHTML += '<p>‚úÖ Configura√ß√£o Firebase obtida</p>';
                
                // Simular login (isso seria feito pelo Firebase normalmente)
                // Como n√£o temos Firebase aqui, vamos testar direto com o backend
                
                // Tentar login direto com email/password (se houver endpoint)
                const loginResponse = await fetch('https://atleticahubapi.onrender.com/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email: email,
                        password: password
                    })
                });
                
                if (loginResponse.ok) {
                    const data = await loginResponse.json();
                    
                    // Salvar token manualmente
                    localStorage.setItem('authToken', data.token);
                    localStorage.setItem('athletica_token', data.token);
                    
                    resultDiv.innerHTML += `
                        <p style="color: green;">‚úÖ Login bem-sucedido!</p>
                        <p>Usu√°rio: ${data.user.nome}</p>
                        <p>Token salvo no localStorage</p>
                    `;
                    
                    verificarToken();
                } else {
                    const error = await loginResponse.text();
                    resultDiv.innerHTML += `
                        <p style="color: red;">‚ùå Erro no login (${loginResponse.status})</p>
                        <p>Detalhes: ${error}</p>
                    `;
                }
                
            } catch (error) {
                resultDiv.innerHTML += `
                    <p style="color: red;">‚ùå Erro: ${error.message}</p>
                `;
            }
        }
        
        // Verificar token inicial
        verificarToken();
    </script>
</body>
</html>
